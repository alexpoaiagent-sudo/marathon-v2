# Связи между ядрами

> Этот документ описывает конкретные интерфейсы и зависимости между ядрами проекта VK-offee.

## Обзор

```
C.FPF (First Principles Framework)
    │
    │ предоставляет философию
    ├─→ Holonic Foundation (A.1)
    ├─→ Bounded Context (A.1.1)
    ├─→ Strict Distinction (A.7)
    ├─→ Trust Calculus (B.3)
    ├─→ Evolution (B.4)
    └─→ Γ Algebra (B.1)
    │
    ▼
A.SRT (Методология)
    │
    │ применяет FPF к SRT-методу
    ├─→ Таблица 3×3 (F0-F9)
    ├─→ Шаблоны документов
    ├─→ Процессы работы с хранилищем
    └─→ Стандарты оформления
    │
    ▼
B.COFFEE (Данные кофейни)
    │
    │ использует методологию
    ├─→ Структуру F0-F9 из A.SRT
    ├─→ Принципы FPF (через A.SRT)
    ├─→ Стандарты оформления из A.SRT
    └─→ Операционные данные кофейни
```

---

## Связь 1: C.FPF → A.SRT (Philosophy Provider)

### Что предоставляет C.FPF

**C.FPF** — источник фундаментальных принципов мышления для всей архитектуры.

#### 1. Holonic Foundation (A.1)

**Источник:** `C.FPF/FPF-Spec.md` Part A

**Применение в A.SRT:**
- Структура SRT 3×3 базируется на холоническом принципе
- Каждое семейство (F0-F9) — это холон: одновременно целое и часть
- Документы организованы как холоны с явными связями

**Правило:**
> Любой элемент в A.SRT должен рассматриваться как холон: определять свои части (подсистемы) и целое (надсистему).

---

#### 2. Bounded Context (A.1.1)

**Источник:** `C.FPF/FPF-Spec.md` Part A.1.1

**Применение в A.SRT:**
- Семейства F0-F9 — это ограниченные контексты
- Термины определяются локально в пределах семейства
- Межсемейственная коммуникация через явные ссылки и bridges

**Правило:**
> Значение термина определяется в пределах семейства. При использовании термина из другого семейства необходима явная ссылка.

---

#### 3. Strict Distinction (A.7)

**Источник:** `C.FPF/FPF-Spec.md` Part A.7

**Применение в A.SRT:**
- **Role** ≠ **Method** ≠ **Work**
- Документы (описания) ≠ Системы (акторы)
- Процесс (как) ≠ Результат (что)

**Правило:**
> В документах A.SRT строго разделяй роли, методы и работу. Не говори "документ делает" — только "система выполняет работу согласно методу".

---

#### 4. Trust & Assurance Calculus (B.3)

**Источник:** `C.FPF/FPF-Spec.md` Part B.3

**Применение в A.SRT:**
- Оценка качества документов через F-G-R tuple:
  - **F (Formality)**: Строгость выражения
  - **G (Claim Scope)**: Область применения
  - **R (Reliability)**: Подкреплённость доказательствами

**Правило:**
> При создании документа в A.SRT явно указывай область применения (G) и уровень формальности (F).

---

#### 5. Evolution Cycles (B.4)

**Источник:** `C.FPF/FPF-Spec.md` Part B.4

**Применение в A.SRT:**
- Процессы обновления хранилища
- Версионирование документов
- Управление изменениями

**Правило:**
> Изменения в A.SRT проходят цикл: Observe → Orient → Decide → Act (OODA).

---

#### 6. Γ Algebra (B.1)

**Источник:** `C.FPF/FPF-Spec.md` Part B.1

**Применение в A.SRT:**
- Композиция документов в семейства
- Агрегация знаний
- Сохранение инвариантов при композиции

**Правило:**
> При объединении документов применяй правила композиции Γ для сохранения целостности.

---

## Связь 2: A.SRT → B.COFFEE (Methodology Provider)

### Что предоставляет A.SRT

#### 1. Структура SRT (Таблица 3×3)

**Источник:** `A.SRT/content/`

**Применение в B.COFFEE:**
- `B.COFFEE/content/0.Management/` — Метасемейство (F0)
- `B.COFFEE/content/1.Suprasystem/` — Надсистема (F1-F3)
- `B.COFFEE/content/2.VkusnyCoffeeNetwork/` — Целевая система (F4-F6)
- `B.COFFEE/content/3.ManagementTeam/` — Система создания (F7-F9)

**Правило:**
> При создании нового семейства в B.COFFEE, смотри эталонную структуру в `A.SRT/content/`

---

#### 2. Применение FPF принципов

**Источник:** `C.FPF/` (транзитивно через A.SRT)

**ВАЖНО:** B.COFFEE **не обращается к C.FPF напрямую**! FPF применяется транзитивно через методологию A.SRT.

**Применение в B.COFFEE (через A.SRT):**
- **Холонический подход (A.1)**: Каждый документ B.COFFEE — часть системы
- **Ограниченные контексты (A.1.1)**: Терминология локальна для каждого семейства
- **Строгое различение (A.7)**: Роль ≠ Человек, План ≠ Реальность
- **Доверие как расчёт (B.3)**: F-G-R оценка информации

**Цепочка применения:**
```
C.FPF (паттерн A.1) → A.SRT (структура 3×3) → B.COFFEE (семейства F0-F9)
```

**Пример в frontmatter:**
```yaml
# В frontmatter документа B.COFFEE
fpf_patterns:
  - A.1   # Holonic Foundation (через A.SRT)
  - B.3   # Trust Calculus (через A.SRT)
```

---

#### 3. Инструкции для AI (CLAUDE.md)

**Источник:** `A.SRT/CLAUDE.md`

**Применение:**
- **Эталон** для создания `B.COFFEE/CLAUDE.md`
- **Алгоритмы** работы с документами
- **Стандарты** YAML frontmatter

**Правило:**
> `B.COFFEE/CLAUDE.md` должен ссылаться на `A.SRT/CLAUDE.md` для базовых концепций, но может добавлять специфику кофейни.

---

#### 4. Шаблоны документов

**Источник:** `A.SRT/templates/`

**Применение в B.COFFEE:**
- Используй шаблоны при создании новых документов
- Адаптируй под специфику кофейни
- Сохраняй структуру frontmatter

**Пример:**
```bash
# При создании документа в B.COFFEE
cp A.SRT/templates/doc-template.md B.COFFEE/content/2.VkusnyCoffeeNetwork/новый-документ.md
```

---

#### 5. Процессы работы с хранилищем

**Источник:** `A.SRT/content/0.Management/0.2. Процессы работы с хранилищем/`

**Ключевые документы:**
- `standards.md` — Стандарты оформления
- `document-creation.md` — Процесс создания документов
- `frontmatter-spec.md` — Спецификация YAML frontmatter

**Применение:**
> При создании документа в B.COFFEE, **обязательно** читай эти документы из A.SRT перед началом работы.

---

## Связь 3: C.FPF → B.COFFEE (Транзитивная через A.SRT)

### Транзитивное применение FPF

**B.COFFEE не взаимодействует с C.FPF напрямую!**

Принципы FPF применяются к B.COFFEE **транзитивно** через A.SRT:

```
C.FPF (философия) → A.SRT (методология) → B.COFFEE (данные)
```

**Исключение:** Глубокий анализ методологии
- Если нужно понять *почему* A.SRT работает так, а не иначе
- Тогда AI-агент может обратиться к C.FPF для понимания фундамента

---

## Связь 4: Feedback Loops

### B.COFFEE → A.SRT (Примеры использования)

Успешные паттерны из B.COFFEE могут быть **обобщены** и добавлены в A.SRT как примеры.

**Процесс:**
1. Найдена удачная структура документа в B.COFFEE
2. Обобщена и адаптирована для A.SRT
3. Добавлена в `A.SRT/example/`

---

### B.COFFEE → A.SRT → C.FPF (Улучшения методологии)

Если в процессе работы обнаружены **недостатки**:

**На уровне методологии A.SRT:**
1. Задокументировать проблему
2. Предложить улучшение в A.SRT
3. Обновить A.SRT
4. Применить обновление в B.COFFEE

**На уровне философии C.FPF:**
1. Если проблема в фундаментальных принципах
2. Обсудить с upstream FPF
3. Обновить C.FPF (если согласовано)
4. Каскадно обновить A.SRT и B.COFFEE

---

## Управление зависимостями

### Версионирование

| Ядро | Версия | Upstream | Обновление |
|------|--------|----------|-----------|
| C.FPF | January 2026 | [alexpoaiagent-sudo/FPF](https://github.com/alexpoaiagent-sudo/FPF) | При изменении философии FPF |
| A.SRT | 1.0 | [alexpoaiagent-sudo/srt-template](https://github.com/alexpoaiagent-sudo/srt-template) | При изменении методологии SRT |
| B.COFFEE | 2.0 | — | При изменении данных кофейни |

### Синхронизация

**При обновлении C.FPF:**
1. Проверь влияние на паттерны, используемые в A.SRT
2. Обнови A.SRT, если нужно переинтерпретировать FPF
3. Каскадно обнови B.COFFEE через A.SRT

**При обновлении A.SRT:**
1. Проверь совместимость с C.FPF (философия)
2. Проверь совместимость с B.COFFEE (применение)
3. Обнови ссылки в `B.COFFEE/CLAUDE.md`
4. Примени новые стандарты к новым документам B.COFFEE

**При обновлении B.COFFEE:**
1. Убедись, что следуешь методологии A.SRT
2. Не переопределяй базовые концепции без явной необходимости
3. Не обращайся к C.FPF напрямую (только через A.SRT)

---

## Команды для работы с ядрами

### Навигация между ядрами

```bash
# Перейти к фундаментальным принципам
cd C.FPF

# Перейти к методологии SRT
cd A.SRT

# Перейти к данным кофейни
cd B.COFFEE

# Вернуться к корню проекта
cd /home/user/VK-offee
```

### Поиск информации

**Где искать философский принцип?**
1. Всегда: `C.FPF/Readme.md` (обзор)
2. Глубоко: `C.FPF/FPF-Spec.md` (через RAG!)

**Где искать определение термина?**
1. Фундамент: `C.FPF/FPF-Spec.md` (если это FPF концепция)
2. Методология: `A.SRT/content/0.Management/0.1. Логика хранилища и знаний/glossary.md`
3. Проект: `B.COFFEE/content/0.Management/0.1. Логика хранилища и знаний/glossary.md`

**Где искать шаблон документа?**
1. Всегда: `A.SRT/templates/`

**Где искать данные о кофейне?**
1. Всегда: `B.COFFEE/content/`

---

## Примеры использования

### Пример 1: Создание нового документа в B.COFFEE

**Задача:** Создать документ "Процесс закупки кофе" в B.COFFEE

**Шаги:**
1. Прочитай `A.SRT/content/0.Management/0.2. Процессы работы с хранилищем/document-creation.md`
2. Определи семейство: F8 (Поставщики и инструменты)
3. Скопируй шаблон из `A.SRT/templates/doc-template.md`
4. Заполни frontmatter по `A.SRT/content/0.Management/0.2. Процессы работы с хранилищем/frontmatter-spec.md`
5. Создай файл: `B.COFFEE/content/3.Constructor/3.2.Architecture/coffee-procurement-process.md`

---

### Пример 2: Проверка соответствия FPF

**Задача:** Проверить документ B.COFFEE на соответствие принципам FPF

**Шаги:**
1. Открой документ в B.COFFEE
2. Прочитай `A.SRT/.fpf/INDEX.md` — локальные принципы
3. Проверь:
   - **A.1 (Холонический подход)**: Есть ли ссылки на связанные документы?
   - **A.7 (Строгое различение)**: Разделены ли роли и люди?
   - **A.1.1 (Ограниченный контекст)**: Определены ли термины локально?
4. Если нужна глубокая проверка, загрузи соответствующую часть `A.SRT/.fpf/FPF-Spec.md`

---

### Пример 3: Обновление методологии A.SRT

**Задача:** Upstream-обновление из исходного srt-template

**Шаги:**
1. Склонируй свежую версию fork: `git clone https://github.com/alexpoaiagent-sudo/srt-template.git /tmp/srt-fresh`
2. Сравни изменения: `diff -r /tmp/srt-fresh A.SRT`
3. Примени нужные обновления в A.SRT
4. Проверь совместимость с B.COFFEE
5. Закоммить изменения

---

## Правила работы

### DO: Правильные практики

✅ **Читай A.SRT перед созданием документов в B.COFFEE**
✅ **Ссылайся на A.SRT для определений терминов**
✅ **Используй шаблоны из A.SRT**
✅ **Применяй принципы FPF из A.SRT**
✅ **Документируй локальные отклонения в B.COFFEE/CLAUDE.md**

### DON'T: Антипаттерны

❌ **Не переопределяй базовые термины SRT в B.COFFEE**
❌ **Не дублируй методологию из A.SRT в B.COFFEE**
❌ **Не изменяй A.SRT без проверки влияния на B.COFFEE**
❌ **Не создавай документы B.COFFEE без чтения A.SRT**

---

## Контрольный список для AI-агентов

При работе с VK-offee, Claude Code должен:

- [ ] Определить, к какому ядру относится задача (A.SRT или B.COFFEE)
- [ ] Если задача в B.COFFEE, проверить методологию в A.SRT
- [ ] Прочитать `A.SRT/CLAUDE.md` для понимания стандартов
- [ ] Применить принципы FPF из `A.SRT/.fpf/INDEX.md`
- [ ] Использовать шаблоны из `A.SRT/templates/`
- [ ] Документировать связи между ядрами в frontmatter

---

**Версия:** 1.0
**Дата:** 2026-01-20
**Автор:** Claude Code + alexpoaiagent-sudo
